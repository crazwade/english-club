import{d as C,l as D,p as F,g,r as v,a as r,i as p,b as l,e as u,w as d,F as i,j as R,q as k,o as c,f as m}from"./index-116ffcad.js";import{_ as q}from"./Result.vue_vue_type_script_setup_true_lang-f45af7e7.js";const E=["src"],P=C({__name:"EditPage",setup(U){const _=D(),b=F(),f=g([]),s=v({type:"success",msg:"",visible:!1}),I=()=>{s.visible=!1;const e=_.query.themeId;b.push({name:"ThemePage",query:{themeId:e}})},o=v({themeId:"",content:"",poster:"",files:[]}),V=e=>{f.value.push(e);const t=new FileReader;return t.onload=()=>{typeof t.result=="string"&&h.value.push(t.result)},t.readAsDataURL(e),!1},h=g([]),w=async()=>{o.themeId=_.query.themeId;try{const e=new FormData;f.value.forEach(n=>{e.append("files[]",n)}),e.append("themeId",o.themeId),e.append("content",o.content),e.append("poster",o.poster);const t=await k.post("http://192.168.86.52/english/uploadInfo.php",e,{headers:{"Content-Type":"multipart/form-data"}});s.msg=t.message,s.type="success",s.visible=!0}catch(e){s.msg=e.message,s.type="error",s.visible=!0}};return(e,t)=>{const n=r("el-button"),x=r("el-upload"),y=r("el-input");return c(),p(i,null,[l(q,{visible:s.visible,type:s.type,msg:s.msg,onClose:I},null,8,["visible","type","msg"]),u("div",null,[l(x,{action:"/uploadInfo","before-upload":V,multiple:""},{default:d(()=>[l(n,{type:"primary"},{default:d(()=>[m("選擇檔案")]),_:1})]),_:1}),l(y,{modelValue:o.poster,"onUpdate:modelValue":t[0]||(t[0]=a=>o.poster=a),placeholder:"你的名字"},null,8,["modelValue"]),l(y,{type:"textarea",modelValue:o.content,"onUpdate:modelValue":t[1]||(t[1]=a=>o.content=a),placeholder:"你的文章",rows:"10"},null,8,["modelValue"]),l(n,{type:"success",onClick:w,class:"mt-3"},{default:d(()=>[m("上傳")]),_:1}),u("div",null,[(c(!0),p(i,null,R(h.value,a=>(c(),p(i,{key:a},[m(" - "),u("img",{src:a,width:"200",height:"100"},null,8,E)],64))),128))])])],64)}}});export{P as default};
