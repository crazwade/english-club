import{d as q,l as z,g as _,r as F,h as R,k as h,a as n,i as b,b as s,w as o,e as a,m as J,F as P,u as H,o as v,f as x,t as V,j as L,c as U,n as G}from"./index-fdd95fa3.js";import{_ as K}from"./Result.vue_vue_type_script_setup_true_lang-a9e3caf5.js";const O={class:"h-full flex flex-col overflow-auto mt-5"},Q={class:"overflow-auto"},W=["onMouseover","onMouseleave"],X={key:0,class:"no-data"},Y=a("div",{class:"card-content"},[a("p",null,"未有資料")],-1),Z={class:"flex items-center justify-center mt-4"},ee=a("span",null,"確定要刪除嗎?",-1),te={class:"dialog-footer"},ne=q({__name:"ThemePage",setup(se){const u=z().query.themeId,c=_([]),d=_(""),e=F({type:"success",msg:"",visible:!1,title:""}),i=_(!1),p=_(-1),D=()=>{e.visible=!1},m=()=>{p.value=-1,i.value=!1},$=()=>{h.push({name:"EditPage",query:{themeId:u.toString()}})},B=t=>{h.push({name:"PersonPage",query:{themeId:u.toString(),postId:t.toString()}})},E=t=>{p.value=t,i.value=!0},M=async()=>{if(p.value===-1){e.msg="不明錯誤請重試",e.type="error",e.visible=!0;return}try{const t=await H().post("/deletePost.php",{postId:p.value});if(!t.success){e.msg=t.message,e.type="error",e.visible=!0,d.value="Error",m();return}await w(),m();return}catch(t){e.msg=t.message,e.type="error",e.visible=!0,m();return}},w=async()=>{try{const t=await H().get("/getAllArticle.php",{params:{themeId:u}});if(!t.success){e.msg=t.message,e.type="error",e.visible=!0,c.value=[],d.value="Error";return}const{list:r,themeName:f}=t.data;c.value=r.map(g=>({...g,deleteHover:!1})),d.value=f;return}catch(t){e.title=t.message,e.msg="使用假資料替代",e.type="error",e.visible=!0,c.value=[{postId:1,poster:"Jacky",deleteHover:!1}];return}};return R(async()=>{u?await w():h.push({name:"HomePage"});const t=document.getElementById("contain");t!==null&&t.scrollHeight>t.clientHeight&&(t.style.overflow="scroll",t.style.paddingBottom="68px")}),(t,r)=>{const f=n("el-tag"),g=n("Delete"),k=n("el-icon"),C=n("el-card"),N=n("el-col"),T=n("el-row"),j=n("DocumentAdd"),I=n("el-button"),A=n("el-dialog");return v(),b(P,null,[s(K,{visible:e.visible,type:e.type,msg:e.msg,title:e.title,onClose:D},null,8,["visible","type","msg","title"]),s(f,{class:"ml-2",type:"warning",size:"large",effect:"dark"},{default:o(()=>[x(V(d.value),1)]),_:1}),a("div",O,[a("div",Q,[s(T,null,{default:o(()=>[(v(!0),b(P,null,L(c.value,(l,S)=>(v(),U(N,{span:12,key:S,class:"relative"},{default:o(()=>[a("div",{class:"absolute bg-gray-400 top-[50%] rounded-full text-gray-700 left-[80%] w-[40px] h-[40px] translate-x-[-50%] translate-y-[-50%] flex justify-center items-center cursor-pointer hover:text-red-500",onMouseover:y=>l.deleteHover=!0,onMouseleave:y=>l.deleteHover=!1},[s(k,{onClick:y=>E(l.postId),class:"text-2xl"},{default:o(()=>[s(g)]),_:2},1032,["onClick"])],40,W),s(C,{style:{margin:"5px"},shadow:"always",onClick:y=>B(l.postId),class:G(["cursor-pointer hover:bg-orange-400",{" bg-red-500":l.deleteHover}]),id:"el-card-body"},{default:o(()=>[a("div",null,V(l.poster),1)]),_:2},1032,["onClick","class"])]),_:2},1024))),128))]),_:1}),c.value.length===0?(v(),b("div",X,[s(C,{class:"w-4/5 mx-auto border border-gray-300"},{default:o(()=>[Y]),_:1})])):J("",!0)]),a("div",Z,[a("div",{class:"w-[60px] h-[60px] rounded-full flex items-center justify-center bg-blue-800 cursor-pointer",onClick:r[0]||(r[0]=l=>$())},[s(k,{size:"30",class:"text-white"},{default:o(()=>[s(j)]),_:1})])])]),s(A,{modelValue:i.value,"onUpdate:modelValue":r[2]||(r[2]=l=>i.value=l),title:"確認",width:"80%","before-close":m},{footer:o(()=>[a("span",te,[s(I,{onClick:r[1]||(r[1]=l=>i.value=!1)},{default:o(()=>[x("先不要")]),_:1}),s(I,{onClick:M,id:"del"},{default:o(()=>[x(" 刪除 ")]),_:1})])]),default:o(()=>[ee]),_:1},8,["modelValue"])],64)}}});export{ne as default};
